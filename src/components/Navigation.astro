---
interface Props {
  currentPath?: string;
  logoSrc?: string;
  logoAlt?: string;
}

const { currentPath = '/', logoSrc = '', logoAlt = 'DC GTFS Dashboard' } = Astro.props;

const navItems = [
  {
    label: 'Feeds',
    href: '/',
    icon: '<path fill="currentColor" d="M118.855 338.285c30.297 0 54.858 24.561 54.858 54.858c0 30.249-24.484 54.78-54.716 54.856h-.283c-30.137-.076-54.562-24.454-54.714-54.573v-.568c.153-30.166 24.654-54.573 54.855-54.573m.002-137.141c106.039 0 192 85.961 192 192c0 19.061-2.778 37.474-7.951 54.855H244.59C251.929 431.2 256 412.647 256 393.144c0-75.742-61.401-137.143-137.143-137.143c-19.504 0-38.058 4.072-54.857 11.412v-58.318c17.382-5.173 35.795-7.951 54.857-7.951M118.854 64c181.781 0 329.144 147.362 329.144 329.143c0 18.69-1.559 37.016-4.552 54.856h-55.793a275.5 275.5 0 0 0 5.488-54.856c-.001-151.484-122.803-274.286-274.287-274.286c-18.785 0-37.13 1.889-54.854 5.487V68.551A331.4 331.4 0 0 1 118.854 64" />'
  },
  {
    label: 'FAQ',
    href: '/faq',
    icon: '<path fill="currentColor" fill-rule="evenodd" d="M334.434 206.171c0 13.516-3.435 25.318-10.288 35.397c-5.65 8.47-15.12 17.649-28.436 27.534c-7.664 5.247-12.711 10.184-15.126 14.823c-3.04 5.648-4.54 14.113-4.54 25.409h-42.666c0-17.137 1.824-29.64 5.454-37.504c4.23-9.483 13.407-19.064 27.521-28.743c6.664-5.045 11.503-10.183 14.529-15.425c3.625-5.852 5.449-12.503 5.449-19.966c0-11.899-3.539-20.766-10.594-26.624c-5.636-4.228-12.502-6.345-20.569-6.345c-13.108 0-22.59 4.339-28.436 13.009c-4.236 6.45-6.36 14.719-6.36 24.8v.304h-45.361c0-26.422 8.36-46.382 25.09-59.898c14.12-11.283 31.574-16.94 52.34-16.94c18.16 0 34.092 3.533 47.798 10.588c22.803 11.703 34.195 31.572 34.195 59.581m134.9 49.83c0 117.82-95.513 213.333-213.334 213.333c-117.82 0-213.333-95.513-213.333-213.334S138.18 42.667 256 42.667S469.334 138.179 469.334 256m-42.667 0c0-94.107-76.561-170.667-170.667-170.667S85.334 161.894 85.334 256S161.894 426.667 256 426.667S426.667 350.106 426.667 256m-170.668 69.333c-14.728 0-26.667 11.938-26.667 26.666s11.94 26.667 26.667 26.667s26.667-11.939 26.667-26.667s-11.94-26.666-26.667-26.666" />'
  }
];
---

<header class="nav-header">
  <div class="nav-container">
    <a class="nav-logo" href="/" aria-label="Home">
      <img src="/logo.svg" alt="" class="nav-logo-icon" aria-hidden="true" />
      <span class="nav-logo-text">GTFS <br>Observatory</span>
    </a>

    <nav class="nav-main">
      <ul class="nav-items">
        {navItems.map(item => (
          <li>
            <a
              class={currentPath === item.href ? 'nav-link active' : 'nav-link'}
              href={item.href}
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="nav-link-icon" aria-hidden="true" set:html={item.icon} />
              {item.label}
            </a>
          </li>
        ))}
        <li>
          <button
            id="theme-toggle"
            class="theme-toggle"
            aria-label="Toggle theme"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path
                fill="currentColor" fill-rule="evenodd" d="M277.333 405.333v85.333h-42.667v-85.333zm99.346-58.824l60.34 60.34l-30.17 30.17l-60.34-60.34zm-241.359 0l30.17 30.17l-60.34 60.34l-30.17-30.17zM256 139.353c64.422 0 116.647 52.224 116.647 116.647c0 64.422-52.225 116.647-116.647 116.647A116.427 116.427 0 0 1 139.352 256c0-64.423 52.225-116.647 116.648-116.647m0 42.666c-40.859 0-73.981 33.123-73.981 74.062a73.76 73.76 0 0 0 21.603 52.296c13.867 13.867 32.685 21.64 52.378 21.603zm234.666 52.647v42.667h-85.333v-42.667zm-384 0v42.667H21.333v-42.667zM105.15 74.98l60.34 60.34l-30.17 30.17l-60.34-60.34zm301.7 0l30.169 30.17l-60.34 60.34l-30.17-30.17zM277.332 21.333v85.333h-42.667V21.333z" />
            </svg>
          </button>
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
  function initNavigation() {
    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');

    // Initialize theme from localStorage or default to light
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);

    const toggleTheme = () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';

      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    };

    if (themeToggle) {
      themeToggle.addEventListener('click', toggleTheme);
    }
  }

  initNavigation();
  document.addEventListener('astro:after-swap', initNavigation);
</script>

<style>
  .nav-header {
    border-bottom: 1px solid var(--pico-muted-border-color);
    padding: 0;
    margin-bottom: 0;
  }

  .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .nav-logo {
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .nav-logo:hover .nav-logo-text {
    color: var(--pico-primary);
  }

  .nav-logo-icon {
    height: 3.5rem;
    width: 3.5rem;
    display: block;
  }

  .nav-logo-text {
    font-size: 1.25rem;
    line-height: 1;
    font-weight: 700;
    color: var(--pico-h1-color);
  }

  .nav-main {
    display: block;
  }

  .nav-items {
    display: flex;
    list-style: none;
    gap: 2rem;
    margin: 0;
    padding: 0;
    align-items: center;
    flex-wrap: wrap;
  }

  .nav-items li {
    margin: 0;
    padding: 0;
  }

  .nav-link {
    text-decoration: none;
    color: var(--pico-muted-color);
    transition: color 0.2s;
    font-size: 0.95rem;
    padding: 0.25rem 0;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    background: none;
    border: none;
    border-radius: 0;
  }

  .nav-link:hover,
  .nav-link.active {
    color: var(--pico-primary);
    background: none;
  }

  .nav-link.active {
    border-bottom: 2px solid var(--pico-primary);
  }

  .nav-link-icon {
    width: 1.1em;
    height: 1.1em;
    display: inline-block;
  }

  .theme-toggle {
    background: none;
    border: none;
    color: var(--pico-muted-color);
    cursor: pointer;
    padding: 0.25rem;
    display: flex;
    align-items: center;
    transition: color 0.2s;
  }

  .theme-toggle:hover {
    color: var(--pico-primary);
  }

  .theme-toggle svg {
    width: 1.25rem;
    height: 1.25rem;
  }

  @media (max-width: 768px) {
    .nav-container {
      gap: 0.75rem;
    }

    .nav-items {
      gap: 1.5rem;
    }
  }
</style>
