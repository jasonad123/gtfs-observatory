---
interface Props {
  currentPath?: string;
  logoSrc?: string;
  logoAlt?: string;
}

const { currentPath = '/', logoSrc = '/service-glyph-short.svg', logoAlt = 'DC GTFS Dashboard' } = Astro.props;

const navItems = [
  { label: 'Feeds', href: '/' },
  { label: 'FAQ', href: '/faq' }
];
---

<header class="nav-header">
  <div class="nav-container">
    <a class="nav-logo" href="/" aria-label="Home">
      <svg class="nav-logo-img" viewBox="0 0 128 48" xmlns="http://www.w3.org/2000/svg" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
        <g transform="matrix(0.050317,0,0,0.050317,35.319742,22.45724)">
          <text x="0px" y="0px" fill="currentColor" style="font-family:'HelveticaNeue-Bold', 'Helvetica Neue';font-weight:700;font-size:243.054px;">GTFS</text>
          <g transform="matrix(1,0,0,1,0,243.054)">
            <text x="0px" y="0px" fill="currentColor" style="font-family:'HelveticaNeue-Bold', 'Helvetica Neue';font-weight:700;font-size:243.054px;">Observatory</text>
          </g>
        </g>
        <g transform="matrix(0.050317,0,0,0.050317,3.274498,10.896713)">
          <rect x="54.167" y="52.083" width="208.333" height="208.333" style="fill:#6ebb46;"/>
        </g>
        <g transform="matrix(0.050317,0,0,0.050317,3.274498,10.896713)">
          <rect x="262.5" y="52.083" width="208.333" height="208.333" style="fill:#5d68c4;"/>
        </g>
        <g transform="matrix(0.050317,0,0,0.050317,3.274498,10.896713)">
          <rect x="54.167" y="260.417" width="208.333" height="208.333" style="fill:#818181;"/>
        </g>
      </svg>
    </a>

    <nav class="nav-main">
      <ul class="nav-items">
        {navItems.map(item => (
          <li>
            <a
              class={currentPath === item.href ? 'nav-link active' : 'nav-link'}
              href={item.href}
            >
              {item.label}
            </a>
          </li>
        ))}
        <li>
          <button
            id="theme-toggle"
            class="theme-toggle"
            aria-label="Toggle theme"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path
                fill="currentColor" fill-rule="evenodd" d="M277.333 405.333v85.333h-42.667v-85.333zm99.346-58.824l60.34 60.34l-30.17 30.17l-60.34-60.34zm-241.359 0l30.17 30.17l-60.34 60.34l-30.17-30.17zM256 139.353c64.422 0 116.647 52.224 116.647 116.647c0 64.422-52.225 116.647-116.647 116.647A116.427 116.427 0 0 1 139.352 256c0-64.423 52.225-116.647 116.648-116.647m0 42.666c-40.859 0-73.981 33.123-73.981 74.062a73.76 73.76 0 0 0 21.603 52.296c13.867 13.867 32.685 21.64 52.378 21.603zm234.666 52.647v42.667h-85.333v-42.667zm-384 0v42.667H21.333v-42.667zM105.15 74.98l60.34 60.34l-30.17 30.17l-60.34-60.34zm301.7 0l30.169 30.17l-60.34 60.34l-30.17-30.17zM277.332 21.333v85.333h-42.667V21.333z" />
            </svg>
          </button>
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
  function initNavigation() {
    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');

    // Initialize theme from localStorage or default to light
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);

    const toggleTheme = () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';

      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    };

    if (themeToggle) {
      themeToggle.addEventListener('click', toggleTheme);
    }
  }

  initNavigation();
  document.addEventListener('astro:after-swap', initNavigation);
</script>

<style>
  .nav-header {
    border-bottom: 1px solid var(--pico-muted-border-color);
    padding: 0;
    margin-bottom: 0;
  }

  .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .nav-logo {
    text-decoration: none;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    color: #000;
  }

  [data-theme=dark] .nav-logo {
    color: #fff;
  }

  .nav-logo:hover {
    color: var(--pico-primary);
  }

  .nav-logo:hover .nav-logo-img {
    color: var(--pico-primary);
  }

  .nav-logo-img {
    height: 2rem;
    width: auto;
    display: block;
  }

  .nav-main {
    display: block;
  }

  .nav-items {
    display: flex;
    list-style: none;
    gap: 2rem;
    margin: 0;
    padding: 0;
    align-items: center;
    flex-wrap: wrap;
  }

  .nav-items li {
    margin: 0;
    padding: 0;
  }

  .nav-link {
    text-decoration: none;
    color: var(--pico-muted-color);
    transition: color 0.2s;
    font-size: 0.95rem;
    padding: 0.25rem 0;
    display: inline-block;
    background: none;
    border: none;
    border-radius: 0;
  }

  .nav-link:hover,
  .nav-link.active {
    color: var(--pico-primary);
    background: none;
  }

  .nav-link.active {
    border-bottom: 2px solid var(--pico-primary);
  }

  .theme-toggle {
    background: none;
    border: none;
    color: var(--pico-muted-color);
    cursor: pointer;
    padding: 0.25rem;
    display: flex;
    align-items: center;
    transition: color 0.2s;
  }

  .theme-toggle:hover {
    color: var(--pico-primary);
  }

  .theme-toggle svg {
    width: 1.25rem;
    height: 1.25rem;
  }

  @media (max-width: 768px) {
    .nav-container {
      gap: 0.75rem;
    }

    .nav-items {
      gap: 1.5rem;
    }
  }
</style>
